<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>On the Origin of Mobile Apps: Network Provenance for Android Applications | Jonathan Crussell</title>
<meta name="keywords" content="android, security, network-provenance, authentication, ad-fraud">
<meta name="description" content="Published at CODASPY 2016.">
<meta name="author" content="Jonathan Crussell">
<link rel="canonical" href="/publication/stevens2016origin/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.cb1b966424391d58a85617e342812e23e741186aa62baaf33e320fa5b85c2b0b.css" integrity="sha256-yxuWZCQ5HVioVhfjQoEuI&#43;dBGGqmK6rzPjIPpbhcKws=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="/publication/stevens2016origin/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="/publication/stevens2016origin/">
  <meta property="og:site_name" content="Jonathan Crussell">
  <meta property="og:title" content="On the Origin of Mobile Apps: Network Provenance for Android Applications">
  <meta property="og:description" content="Published at CODASPY 2016.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="publication">
    <meta property="article:published_time" content="2016-03-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2016-03-09T00:00:00+00:00">
    <meta property="article:tag" content="Android">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="Network-Provenance">
    <meta property="article:tag" content="Authentication">
    <meta property="article:tag" content="Ad-Fraud">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="On the Origin of Mobile Apps: Network Provenance for Android Applications">
<meta name="twitter:description" content="Published at CODASPY 2016.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Publications",
      "item": "/publication/"
    }
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "On the Origin of Mobile Apps: Network Provenance for Android Applications",
      "item": "/publication/stevens2016origin/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "On the Origin of Mobile Apps: Network Provenance for Android Applications",
  "name": "On the Origin of Mobile Apps: Network Provenance for Android Applications",
  "description": "Published at CODASPY 2016.",
  "keywords": [
    "android", "security", "network-provenance", "authentication", "ad-fraud"
  ],
  "articleBody": "Ryan Stevens, Jonathan Crussell, Hao Chen\nProceedings of the Sixth ACM Conference on Data and Application Security and Privacy (CODASPY 2016)\nAbstract Many mobile services consist of two components: a server providing an API, and an application running on smartphones and communicating with the API. An unresolved problem in this design is that it is difficult for the server to authenticate which app is accessing the API. This causes many security problems. For example, the provider of a private network API has to embed secrets in its official app to ensure that only this app can access the API; however, attackers can uncover the secret by reverse-engineering. As another example, malicious apps may send automatic requests to ad servers to commit ad fraud.\nIn this work, we propose a system that allows network API to authenticate the mobile app that sends each request so that the API can make an informed access control decision. Our system, the Mobile Trusted-Origin Policy, consists of two parts: 1) an app provenance mechanism that annotates outgoing HTTP(S) requests with information about which app generated the network traffic, and 2) a code isolation mechanism that separates code within an app that should have different app provenance signatures into mobile origin. As motivation for our work, we present two previously-unknown families of apps that perform click fraud, and examine how the lack of mobile origin information enables the attacks. Based on our observations, we propose Trusted Cross-Origin Requests to handle point (1), which automatically includes mobile origin information in outgoing HTTP requests. Servers may then decide, based on the mobile origin data, whether to process the request or not. We implement a prototype of our system for Android and evaluate its performance, security, and deployability. We find that our system can achieve our security and utility goals with negligible overhead.\nCitation @inproceedings{stevens2016origin, title={On the origin of mobile apps: Network provenance for android applications}, author={Stevens, Ryan and Crussell, Jonathan and Chen, Hao}, booktitle={Proceedings of the Sixth ACM Conference on Data and Application Security and Privacy}, pages={160--171}, year={2016} } Copy Links:\nPDF ",
  "wordCount" : "344",
  "inLanguage": "en",
  "datePublished": "2016-03-09T00:00:00Z",
  "dateModified": "2016-03-09T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Jonathan Crussell"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/publication/stevens2016origin/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jonathan Crussell",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="/" accesskey="h" title="Jonathan Crussell (Alt + H)">Jonathan Crussell</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="/" title="Home">
                    <span>Home</span>
                </a>
            </li>
            <li>
                <a href="/publication/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="/project/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="/post/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="/">Home</a>&nbsp;»&nbsp;<a href="/publication/">Publications</a></div>
    <h1 class="post-title entry-hint-parent">
      On the Origin of Mobile Apps: Network Provenance for Android Applications
    </h1>
    <div class="post-description">
      Published at CODASPY 2016.
    </div>
    <div class="post-meta"><span title='2016-03-09 00:00:00 +0000 UTC'>March 9, 2016</span>&nbsp;·&nbsp;<span>2 min</span>&nbsp;·&nbsp;<span>Jonathan Crussell</span>

</div>
  </header> 
  <div class="post-content"><p><strong>Ryan Stevens, Jonathan Crussell, Hao Chen</strong></p>
<p><em>Proceedings of the Sixth ACM Conference on Data and Application Security and Privacy (CODASPY 2016)</em></p>
<h2 id="abstract">Abstract<a hidden class="anchor" aria-hidden="true" href="#abstract">#</a></h2>
<p>Many mobile services consist of two components: a server providing an API, and
an application running on smartphones and communicating with the API. An
unresolved problem in this design is that it is difficult for the server to
authenticate which app is accessing the API. This causes many security
problems. For example, the provider of a private network API has to embed
secrets in its official app to ensure that only this app can access the API;
however, attackers can uncover the secret by reverse-engineering. As another
example, malicious apps may send automatic requests to ad servers to commit ad
fraud.</p>
<p>In this work, we propose a system that allows network API to authenticate the
mobile app that sends each request so that the API can make an informed access
control decision. Our system, the Mobile Trusted-Origin Policy, consists of two
parts: 1) an app provenance mechanism that annotates outgoing HTTP(S) requests
with information about which app generated the network traffic, and 2) a code
isolation mechanism that separates code within an app that should have
different app provenance signatures into mobile origin. As motivation for our
work, we present two previously-unknown families of apps that perform click
fraud, and examine how the lack of mobile origin information enables the
attacks. Based on our observations, we propose Trusted Cross-Origin Requests to
handle point (1), which automatically includes mobile origin information in
outgoing HTTP requests. Servers may then decide, based on the mobile origin
data, whether to process the request or not. We implement a prototype of our
system for Android and evaluate its performance, security, and deployability.
We find that our system can achieve our security and utility goals with
negligible overhead.</p>
<div class="citation-section">
  <h2>Citation</h2>
  <div class="citation-container">
    <pre class="citation-code"><code class="language-bibtex">@inproceedings{stevens2016origin,
  title={On the origin of mobile apps: Network provenance for android applications},
  author={Stevens, Ryan and Crussell, Jonathan and Chen, Hao},
  booktitle={Proceedings of the Sixth ACM Conference on Data and Application Security and Privacy},
  pages={160--171},
  year={2016}
}
</code></pre>
    <button class="citation-copy-btn" onclick="copyCitation(this)" aria-label="Copy citation">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
      </svg>
      <span class="copy-text">Copy</span>
    </button>
  </div>
</div>

<script>
function copyCitation(button) {
  const citeBlock = button.parentElement.querySelector('.citation-code code');
  const text = citeBlock.textContent;

  navigator.clipboard.writeText(text).then(() => {
    const copyText = button.querySelector('.copy-text');
    const originalText = copyText.textContent;
    copyText.textContent = 'Copied!';

    setTimeout(() => {
      copyText.textContent = originalText;
    }, 2000);
  }).catch(err => {
    console.error('Failed to copy:', err);
  });
}
</script>
<hr />
<p><strong>Links:</strong></p>
<ul>
<li><a href="/pdf/stevens2016origin.pdf">PDF</a></li>
</ul>



  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/android/">Android</a></li>
      <li><a href="/tags/security/">Security</a></li>
      <li><a href="/tags/network-provenance/">Network-Provenance</a></li>
      <li><a href="/tags/authentication/">Authentication</a></li>
      <li><a href="/tags/ad-fraud/">Ad-Fraud</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© 2020-2026</span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
